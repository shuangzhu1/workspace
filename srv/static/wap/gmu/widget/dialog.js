/**
 * dialog
 * src/widget/dialog/dialog.js,src/widget/dialog/$position.js,/src/extend/parseTpl.js
 **/
!function(a,b,c){var d={close:'<a class="ui-dialog-close" title="\u5173\u95ed"><span class="ui-icon ui-icon-delete"></span></a>',mask:'<div class="ui-mask"></div>',title:'<div class="ui-dialog-title"><h3><%=title%></h3></div>',wrap:'<div class="ui-dialog"><div class="ui-dialog-content"></div><% if(btns){ %><div class="ui-dialog-btns"><% for(var i=0, length=btns.length; i<length; i++){var item = btns[i]; %><a class="ui-btn ui-btn-<%=item.index%>" data-key="<%=item.key%>"><%=item.text%></a><% } %></div><% } %></div> '};a.define("Dialog",{options:{autoOpen:!0,buttons:null,closeBtn:!0,mask:!0,width:300,height:"auto",title:null,content:null,scrollMove:!0,container:null,maskClick:null,position:null},getWrap:function(){return this._options._wrap},_init:function(){var e,a=this,c=a._options,f=0,g=b.proxy(a._eventHandler,a),h={};a.on("ready",function(){c._container=b(c.container||document.body),(c._cIsBody=c._container.is("body"))||c._container.addClass("ui-dialog-container"),h.btns=e=[],c.buttons&&b.each(c.buttons,function(a){e.push({index:++f,text:a,key:a})}),c._mask=c.mask?b(d.mask).appendTo(c._container):null,c._wrap=b(b.parseTpl(d.wrap,h)).appendTo(c._container),c._content=b(".ui-dialog-content",c._wrap),c._title=b(d.title),c._close=c.closeBtn&&b(d.close).highlight("ui-dialog-close-hover"),a.$el=a.$el||c._content,a.title(c.title),a.content(c.content),e.length&&b(".ui-dialog-btns .ui-btn",c._wrap).highlight("ui-state-hover"),c._wrap.css({width:c.width,height:c.height}),b(window).on("ortchange",g),c._wrap.on("click",g),c._mask&&c._mask.on("click",g),c.autoOpen&&a.open()})},_create:function(){var a=this._options;this._options.setup&&(a.content=a.content||this.$el.show(),a.title=a.title||this.$el.attr("title"))},_eventHandler:function(a){var d,e,g,c=this,f=c._options;switch(a.type){case"ortchange":this.refresh();break;case"touchmove":f.scrollMove&&a.preventDefault();break;case"click":if(f._mask&&(b.contains(f._mask[0],a.target)||f._mask[0]===a.target))return c.trigger("maskClick");e=f._wrap.get(0),(d=b(a.target).closest(".ui-dialog-close",e))&&d.length?c.close():(d=b(a.target).closest(".ui-dialog-btns .ui-btn",e))&&d.length&&(g=f.buttons[d.attr("data-key")],g&&g.apply(c,arguments))}},_calculate:function(){var d,e,a=this,c=a._options,f=document.body,g={},h=c._cIsBody,i=Math.round;return c.mask&&(g.mask=h?{width:"100%",height:Math.max(f.scrollHeight,f.clientHeight)-1}:{width:"100%",height:"100%"}),d=c._wrap.offset(),e=b(window),g.wrap={left:"50%",marginLeft:-i(d.width/2)+"px",top:h?i(e.height()/2)+window.pageYOffset:"50%",marginTop:-i(d.height/2)+"px"},g},refresh:function(){var d,e,a=this,c=a._options;return c._isOpen&&(e=function(){d=a._calculate(),d.mask&&c._mask.css(d.mask),c._wrap.css(d.wrap)},b.os.ios&&document.activeElement&&/input|textarea|select/i.test(document.activeElement.tagName)?(document.body.scrollLeft=0,b.later(e,200)):e()),a},open:function(a,d){var e=this._options;return e._isOpen=!0,e._wrap.css("display","block"),e._mask&&e._mask.css("display","block"),a!==c&&this.position?this.position(a,d):this.refresh(),b(document).on("touchmove",b.proxy(this._eventHandler,this)),this.trigger("open")},close:function(){var a,c=this._options;return a=b.Event("beforeClose"),this.trigger(a),a.defaultPrevented?this:(c._isOpen=!1,c._wrap.css("display","none"),c._mask&&c._mask.css("display","none"),b(document).off("touchmove",this._eventHandler),this.trigger("close"))},title:function(a){var b=this._options,d=a!==c;return d&&(a=(b.title=a)?"<h3>"+a+"</h3>":a,b._title.html(a)[a?"prependTo":"remove"](b._wrap),b._close&&b._close.prependTo(b.title?b._title:b._wrap)),d?this:b.title},content:function(a){var b=this._options,d=a!==c;return d&&b._content.empty().append(b.content=a),d?this:b.content},destroy:function(){var a=this._options,c=this._eventHandler;return b(window).off("ortchange",c),b(document).off("touchmove",c),a._wrap.off("click",c).remove(),a._mask&&a._mask.off("click",c).remove(),a._close&&a._close.highlight(),this.$super("destroy")}})}(gmu,gmu.$);
!function(a,b){a.Dialog.register("position",{_init:function(){var a=this._options;a.position=a.position||{of:a.container||window,at:"center",my:"center"}},position:function(a,c){var d=this._options;return b.isPlainObject(a)?b.extend(d.position,a):d.position.at="left"+(a>0?"+"+a:a)+" top"+(c>0?"+"+c:c),this.refresh()},_calculate:function(){var a=this,c=a._options,d=c.position,e=a.origin();return c._wrap.position(b.extend(d,{using:function(a){e.wrap=a}})),e}})}(gmu,gmu.$);